<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist BE Contr√¥le Qualit√© - Diagnostic Photovolta√Øque</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #3498db 0%, #2c3e50 100%);
            padding: 20px;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.95;
        }
        
        .info-section {
            padding: 25px 30px;
            background: #f8f9fa;
            border-bottom: 3px solid #e9ecef;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .info-item {
            background: white;
            padding: 12px;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .info-item label {
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 12px;
            text-transform: uppercase;
        }
        
        .info-item input,
        .info-item select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .section {
            padding: 25px 30px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .section:last-child {
            border-bottom: none;
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #3498db;
        }
        
        .section-icon {
            font-size: 32px;
            margin-right: 15px;
        }
        
        .section-title {
            flex: 1;
        }
        
        .section-title h2 {
            color: #2c3e50;
            font-size: 22px;
            margin-bottom: 5px;
        }
        
        .section-title p {
            color: #7f8c8d;
            font-size: 13px;
        }
        
        .section-progress {
            font-size: 18px;
            font-weight: 600;
            color: #3498db;
        }
        
        .checklist-item {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            border-left: 4px solid #95a5a6;
            transition: all 0.3s ease;
        }
        
        .checklist-item.checked {
            background: #d4edda;
            border-left-color: #27ae60;
        }
        
        .checklist-item.warning {
            background: #fff3cd;
            border-left-color: #f39c12;
        }
        
        .checklist-item.error {
            background: #f8d7da;
            border-left-color: #e74c3c;
        }
        
        .checklist-item.critical {
            border-left-color: #e74c3c;
        }
        
        .checklist-item.critical.checked {
            border-left-color: #27ae60;
        }
        
        .item-header {
            display: flex;
            align-items: flex-start;
            margin-bottom: 8px;
        }
        
        .item-checkbox {
            width: 22px;
            height: 22px;
            margin-right: 12px;
            margin-top: 2px;
            cursor: pointer;
            flex-shrink: 0;
        }
        
        .item-status {
            width: 120px;
            padding: 6px;
            margin-left: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 13px;
        }
        
        .item-content {
            flex: 1;
        }
        
        .item-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
            font-size: 15px;
        }
        
        .item-description {
            color: #7f8c8d;
            font-size: 13px;
            line-height: 1.5;
        }
        
        .item-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
            margin-left: 8px;
        }
        
        .badge-critical {
            background: #fee;
            color: #e74c3c;
        }
        
        .badge-auto {
            background: #e3f2fd;
            color: #2196f3;
        }
        
        .item-notes {
            width: 100%;
            margin-top: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 13px;
            resize: vertical;
            min-height: 60px;
        }
        
        .item-input {
            width: 100%;
            margin-top: 10px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 13px;
        }
        
        .global-progress {
            position: sticky;
            top: 0;
            background: #2c3e50;
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 100;
        }
        
        .progress-bar {
            flex: 1;
            height: 12px;
            background: #34495e;
            border-radius: 6px;
            margin: 0 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2980b9);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .status-summary {
            padding: 20px 30px;
            background: #f8f9fa;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .status-card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #95a5a6;
            text-align: center;
        }
        
        .status-card.ok {
            border-left-color: #27ae60;
        }
        
        .status-card.warning {
            border-left-color: #f39c12;
        }
        
        .status-card.error {
            border-left-color: #e74c3c;
        }
        
        .status-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .status-label {
            font-size: 13px;
            color: #7f8c8d;
            text-transform: uppercase;
        }
        
        .actions {
            padding: 30px;
            background: #f8f9fa;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .btn {
            flex: 1;
            min-width: 150px;
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(52, 152, 219, 0.4);
        }
        
        .btn-success {
            background: #27ae60;
            color: white;
        }
        
        .btn-success:hover {
            background: #229954;
        }
        
        .btn-warning {
            background: #f39c12;
            color: white;
        }
        
        .btn-warning:hover {
            background: #e67e22;
        }
        
        .btn-secondary {
            background: #95a5a6;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .footer {
            padding: 20px 30px;
            background: #2c3e50;
            color: white;
            text-align: center;
            font-size: 13px;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .global-progress,
            .actions {
                display: none;
            }
            
            .container {
                box-shadow: none;
            }
            
            .section {
                page-break-inside: avoid;
            }
        }
        
        @media (max-width: 768px) {
            .info-grid,
            .status-summary {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Progress Bar Global -->
        <div class="global-progress">
            <div style="font-weight: 600;">Contr√¥le Qualit√© BE</div>
            <div class="progress-bar">
                <div class="progress-fill" id="globalProgress"></div>
            </div>
            <div id="globalProgressText" style="font-weight: 600;">0/45 (0%)</div>
        </div>
        
        <!-- Header -->
        <div class="header">
            <h1>üîç CHECKLIST BE CONTR√îLE QUALIT√â</h1>
            <p>Validation Retour Terrain - Bureau d'√âtudes Diagnostic Photovolta√Øque</p>
            <p style="margin-top: 10px; font-size: 12px;">Version 2.0 | Mission GIRASOLE 2025</p>
        </div>
        
        <!-- Informations Mission -->
        <div class="info-section">
            <h3 style="margin-bottom: 15px; color: #2c3e50;">üìã INFORMATIONS MISSION</h3>
            <div class="info-grid">
                <div class="info-item">
                    <label>Centrale</label>
                    <input type="text" id="centrale" placeholder="Nom centrale">
                </div>
                <div class="info-item">
                    <label>Date intervention</label>
                    <input type="date" id="dateIntervention">
                </div>
                <div class="info-item">
                    <label>Techniciens terrain</label>
                    <input type="text" id="techniciens" placeholder="Nom(s) technicien(s)">
                </div>
                <div class="info-item">
                    <label>Validateur BE</label>
                    <input type="text" id="validateur" placeholder="Votre nom">
                </div>
                <div class="info-item">
                    <label>Date contr√¥le BE</label>
                    <input type="date" id="dateControle">
                </div>
                <div class="info-item">
                    <label>Statut validation</label>
                    <select id="statutValidation">
                        <option value="">-- S√©lectionner --</option>
                        <option value="en_cours">En cours contr√¥le</option>
                        <option value="conforme">‚úÖ Conforme</option>
                        <option value="reserve_mineure">‚ö†Ô∏è R√©serves mineures</option>
                        <option value="reserve_majeure">üî¥ R√©serves majeures</option>
                        <option value="refuse">‚ùå Refus√© - √Ä refaire</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- R√©sum√© Statut -->
        <div class="status-summary">
            <div class="status-card ok">
                <div class="status-value" id="nbConformes">0</div>
                <div class="status-label">‚úÖ Conformes</div>
            </div>
            <div class="status-card warning">
                <div class="status-value" id="nbAvertissements">0</div>
                <div class="status-label">‚ö†Ô∏è R√©serves mineures</div>
            </div>
            <div class="status-card error">
                <div class="status-value" id="nbErreurs">0</div>
                <div class="status-label">üî¥ R√©serves majeures</div>
            </div>
            <div class="status-card">
                <div class="status-value" id="tauxCompletude">0%</div>
                <div class="status-label">üìä Compl√©tude</div>
            </div>
        </div>
        
        <!-- SECTION 1: COMPL√âTUDE DONN√âES -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon">üì¶</div>
                <div class="section-title">
                    <h2>1. COMPL√âTUDE DONN√âES (10 min)</h2>
                    <p>V√©rification r√©ception et exhaustivit√© fichiers terrain</p>
                </div>
                <div class="section-progress" data-section="1">0/10</div>
            </div>
            
            <div class="checklist-item critical" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Checklist terrain HTML/JSON re√ßue <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">Fichier JSON intervention pr√©sent, structure valide, aucune corruption</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Observations (nom fichier, erreurs d√©tect√©es...)"></textarea>
            </div>
            
            <div class="checklist-item critical" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Photos nomenclature compl√®tes <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">Nb photos minimum atteint (g√©n√©rales ‚â•5, modules ‚â•10, onduleurs ‚â•5), nomenclature respect√©e</div>
                        <input type="text" class="item-input" placeholder="Nb photos re√ßues : G√©n√©rales=X, Modules=X, Onduleurs=X, Anomalies=X">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Photos manquantes, erreurs nomenclature..."></textarea>
            </div>
            
            <div class="checklist-item critical" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Images thermographie re√ßues <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">Dossier images IR complet, couverture champ PV 100%, formats exploitables (TIFF/JPG)</div>
                        <input type="text" class="item-input" placeholder="Nb images thermographie re√ßues, r√©solution, qualit√©...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Zones non couvertes, qualit√© images insuffisante..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Images √©lectroluminescence re√ßues (si applicable)</div>
                        <div class="item-description">Dossier images EL complet, acquisition nocturne valid√©e, formats exploitables</div>
                        <input type="text" class="item-input" placeholder="Nb images EL re√ßues, qualit√© acquisition...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                        <option value="na">N/A</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Donn√©es DOE centrale accessibles</div>
                        <div class="item-description">Plans calepinage, sch√©mas √©lectriques, fiches techniques modules/onduleurs pr√©sents</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Mesures √©lectriques document√©es</div>
                        <div class="item-description">Tensions Voc, courants Isc, isolement, terre not√©s dans JSON ou fichier d√©di√©</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Conditions intervention renseign√©es</div>
                        <div class="item-description">M√©t√©o, irradiation, temp√©rature modules, conditions acquisition document√©es</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Observations terrain compl√©t√©es</div>
                        <div class="item-description">Champs notes checklist remplis, anomalies d√©crites pr√©cis√©ment, contexte clair</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Bon intervention sign√© (si applicable)</div>
                        <div class="item-description">Signature client attestant r√©alisation prestation, scan/photo re√ßu</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="na">N/A</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="1">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">D√©lai transmission respect√©</div>
                        <div class="item-description">Upload data < 48h post-intervention (sauf EL nocturne possible +24h)</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è R√©serve</option>
                        <option value="error">üî¥ Erreur</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- SECTION 2: VALIDATION MESURES √âLECTRIQUES -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon">‚ö°</div>
                <div class="section-title">
                    <h2>2. VALIDATION MESURES √âLECTRIQUES (10 min)</h2>
                    <p>Coh√©rence valeurs, conformit√© normes, d√©tection anomalies</p>
                </div>
                <div class="section-progress" data-section="2">0/10</div>
            </div>
            
            <div class="checklist-item critical" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Tensions Voc coh√©rentes vs th√©orique <span class="item-badge badge-critical">CRITIQUE</span> <span class="item-badge badge-auto">AUTO</span></div>
                        <div class="item-description">V√©rification Voc strings dans plage ¬±10% valeur th√©orique (Voc_module √ó nb_modules √ó coeff_T)</div>
                        <input type="text" class="item-input" placeholder="Voc th√©orique attendu (V), Voc min/max mesur√©s (V), √©carts (%)...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è √âcart 10-20%</option>
                        <option value="error">üî¥ √âcart >20%</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Strings hors plage identifi√©s, hypoth√®ses causes (ombrage, d√©fauts modules, erreur mesure...)"></textarea>
            </div>
            
            <div class="checklist-item" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Courants Isc homog√®nes entre strings <span class="item-badge badge-auto">AUTO</span></div>
                        <div class="item-description">V√©rification √©carts Isc strings < 10% (hors ombrages identifi√©s), coh√©rence vs irradiation</div>
                        <input type="text" class="item-input" placeholder="Isc moyen (A), Isc min/max (A), √©cart-type (%)...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è √âcart 10-15%</option>
                        <option value="error">üî¥ √âcart >15%</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Strings valeurs atypiques, causes probables..."></textarea>
            </div>
            
            <div class="checklist-item critical" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">R√©sistance isolement DC conforme <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">Isolement > 1 MŒ© exig√© norme IEC 62446-1 (test 500V DC)</div>
                        <input type="text" class="item-input" placeholder="Isolement mesur√© + vers terre (MŒ©), - vers terre (MŒ©)">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK (>1 MŒ©)</option>
                        <option value="warning">‚ö†Ô∏è Limite (0.5-1 MŒ©)</option>
                        <option value="error">üî¥ Non conforme (<0.5 MŒ©)</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Si non conforme : actions correctives n√©cessaires, urgence intervention..."></textarea>
            </div>
            
            <div class="checklist-item critical" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">R√©sistance terre conforme <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">Terre < 100 Œ© (NF C 15-100), continuit√© masses < 0.5 Œ©</div>
                        <input type="text" class="item-input" placeholder="R√©sistance terre mesur√©e (Œ©), continuit√© masses (Œ©)">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK (<100 Œ©)</option>
                        <option value="warning">‚ö†Ô∏è Limite (100-200 Œ©)</option>
                        <option value="error">üî¥ Non conforme (>200 Œ©)</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Si non conforme : travaux n√©cessaires, mise en s√©curit√©..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Tensions MPPT onduleurs dans plage</div>
                        <div class="item-description">Tensions DC entr√©e onduleurs entre Vmin et Vmax constructeur, √©quilibrage MPPT OK</div>
                        <input type="text" class="item-input" placeholder="Tensions MPPT mesur√©es vs plage onduleur (V)">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Proche limites</option>
                        <option value="error">üî¥ Hors plage</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Tensions AC sortie √©quilibr√©es</div>
                        <div class="item-description">Tensions triphas√©es d√©s√©quilibre < 5%, conformit√© r√©seau 230V/400V ¬±10%</div>
                        <input type="text" class="item-input" placeholder="Tensions AC mesur√©es L1/L2/L3 (V), d√©s√©quilibre (%)">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è D√©s√©quilibre 5-8%</option>
                        <option value="error">üî¥ D√©s√©quilibre >8%</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Puissance instantan√©e coh√©rente <span class="item-badge badge-auto">AUTO</span></div>
                        <div class="item-description">V√©rification P_instantan√©e vs P_cr√™te √ó (Irradiation/1000) √ó PR_estim√© (0.75-0.85)</div>
                        <input type="text" class="item-input" placeholder="P instantan√©e (kW), Irradiation (W/m¬≤), P th√©orique attendue (kW), √©cart (%)">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è √âcart 15-25%</option>
                        <option value="error">üî¥ √âcart >25%</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Si √©cart important : hypoth√®ses (salissures, ombrages, d√©gradation, d√©fauts)..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Courbes I-V analys√©es (si disponibles)</div>
                        <div class="item-description">Forme courbes normale (FF > 0.7), absence marches/d√©crochages, Pmax coh√©rente</div>
                        <input type="text" class="item-input" placeholder="Nb courbes I-V analys√©es, FF moyen, Pmax vs th√©orique (%)">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Anomalies mineures</option>
                        <option value="error">üî¥ Anomalies majeures</option>
                        <option value="na">N/A</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Historique production coh√©rent</div>
                        <div class="item-description">Production kWh/j dans range attendu, absence baisses anormales r√©centes, PR > 0.75</div>
                        <input type="text" class="item-input" placeholder="Production moyenne (kWh/j), PR calcul√©, tendances...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è PR 0.65-0.75</option>
                        <option value="error">üî¥ PR <0.65</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="2">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Codes erreurs onduleurs analys√©s</div>
                        <div class="item-description">Erreurs critiques identifi√©es, fr√©quence √©valu√©e, actions correctives d√©finies</div>
                        <input type="text" class="item-input" placeholder="Codes erreurs d√©tect√©s, fr√©quence, gravit√©...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Aucune erreur</option>
                        <option value="warning">‚ö†Ô∏è Erreurs mineures</option>
                        <option value="error">üî¥ Erreurs critiques</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- SECTION 3: VALIDATION IMAGES & PHOTOS -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon">üì∏</div>
                <div class="section-title">
                    <h2>3. VALIDATION IMAGES & PHOTOS (15 min)</h2>
                    <p>Qualit√© images, nomenclature, analyse d√©fauts visuels</p>
                </div>
                <div class="section-progress" data-section="3">0/10</div>
            </div>
            
            <div class="checklist-item critical" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Nomenclature photos 100% respect√©e <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">Nommage fichiers conforme standard GIRASOLE, aucune erreur nomenclature, tra√ßabilit√© OK</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK 100%</option>
                        <option value="warning">‚ö†Ô∏è Erreurs <5%</option>
                        <option value="error">üî¥ Erreurs >5%</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Photos mal nomm√©es identifi√©es, corrections n√©cessaires..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Qualit√© photos suffisante</div>
                        <div class="item-description">Nettet√© OK, √©clairage adapt√©, cadrage correct, r√©solution exploitable (min 1920x1080)</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Qualit√© moyenne</option>
                        <option value="error">üî¥ Qualit√© insuffisante</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Photos floues, sous/sur-expos√©es √† refaire..."></textarea>
            </div>
            
            <div class="checklist-item critical" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Images thermographie exploitables <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">R√©solution suffisante (2-3 cm/px), dynamique thermique correcte, couverture compl√®te champ PV</div>
                        <input type="text" class="item-input" placeholder="R√©solution images (px), couverture (%), qualit√© thermique...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Qualit√© limite</option>
                        <option value="error">üî¥ Inexploitable</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Zones mal couvertes, r√©solution insuffisante, probl√®mes d√©tect√©s..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Anomalies thermiques identifi√©es</div>
                        <div class="item-description">Hotspots, √©carts temp√©rature >10¬∞C, d√©fauts diodes bypass d√©tect√©s et localis√©s</div>
                        <input type="text" class="item-input" placeholder="Nb anomalies thermiques d√©tect√©es, types, localisation...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Identifi√©es</option>
                        <option value="warning">‚ö†Ô∏è Analyse incompl√®te</option>
                        <option value="error">üî¥ Non trait√©es</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="D√©tail anomalies thermiques (string, module, gravit√© estim√©e, ŒîT)..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Images EL exploitables (si applicable)</div>
                        <div class="item-description">Exposition correcte, contraste suffisant, d√©finition cellules visible, g√©or√©f√©rencement OK</div>
                        <input type="text" class="item-input" placeholder="Qualit√© images EL, temps exposition, nb modules analysables...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Qualit√© limite</option>
                        <option value="error">üî¥ Inexploitable</option>
                        <option value="na">N/A</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">D√©fauts EL identifi√©s (si applicable)</div>
                        <div class="item-description">Microfissures, cellules inactives, PID, d√©lamination d√©tect√©s et quantifi√©s</div>
                        <input type="text" class="item-input" placeholder="Nb modules d√©fauts EL, types d√©fauts, gravit√©...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Identifi√©s</option>
                        <option value="warning">‚ö†Ô∏è Analyse incompl√®te</option>
                        <option value="error">üî¥ Non trait√©s</option>
                        <option value="na">N/A</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">D√©fauts visuels modules document√©s</div>
                        <div class="item-description">Fissures, d√©lamination, salissures, ombres photographi√©s, nb modules affect√©s estim√©</div>
                        <input type="text" class="item-input" placeholder="Types d√©fauts visuels, nb modules estim√©, localisation...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Documentation partielle</option>
                        <option value="error">üî¥ Insuffisant</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Anomalies structures/c√¢blages photographi√©es</div>
                        <div class="item-description">Corrosion, c√¢bles endommag√©s, connecteurs d√©fectueux document√©s visuellement</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Documentation partielle</option>
                        <option value="error">üî¥ Insuffisant</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Environnement site document√©</div>
                        <div class="item-description">Vues ensemble, acc√®s, v√©g√©tation proche, sources ombrage photographi√©es</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Documentation partielle</option>
                        <option value="error">üî¥ Insuffisant</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="3">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Plaques signal√©tiques lisibles</div>
                        <div class="item-description">Photos √©tiquettes modules, onduleurs, tableau √©lectrique exploitables (r√©f√©rences, puissances)</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ OK</option>
                        <option value="warning">‚ö†Ô∏è Partiellement lisibles</option>
                        <option value="error">üî¥ Illisibles</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- SECTION 4: ANALYSE TECHNIQUE -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon">üî¨</div>
                <div class="section-title">
                    <h2>4. ANALYSE TECHNIQUE BE (15 min)</h2>
                    <p>Synth√®se d√©fauts, classification gravit√©, recommandations</p>
                </div>
                <div class="section-progress" data-section="4">0/8</div>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">D√©fauts critiques identifi√©s et class√©s <span class="item-badge badge-auto">AUTO</span></div>
                        <div class="item-description">Classification : Critique (arr√™t prod/danger) / Majeur (perte >10%) / Mineur (perte <10%)</div>
                        <input type="text" class="item-input" placeholder="Nb d√©fauts critiques, majeures, mineures...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Class√©s</option>
                        <option value="warning">‚ö†Ô∏è Classification partielle</option>
                        <option value="error">üî¥ Non class√©s</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="D√©tail d√©fauts critiques/majeurs (localisation, impact prod estim√©, urgence)..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Impact production estim√© <span class="item-badge badge-auto">AUTO</span></div>
                        <div class="item-description">Calcul pertes kWh/an, ‚Ç¨/an par d√©faut (selon PR d√©grad√©, tarif rachat/vente)</div>
                        <input type="text" class="item-input" placeholder="Pertes estim√©es (kWh/an), (‚Ç¨/an), PR actuel vs optimal...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Calcul√©</option>
                        <option value="warning">‚ö†Ô∏è Estimation grossi√®re</option>
                        <option value="error">üî¥ Non estim√©</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Causes racines identifi√©es</div>
                        <div class="item-description">Root cause analysis d√©fauts (conception, installation, exploitation, vieillissement)</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Identifi√©es</option>
                        <option value="warning">‚ö†Ô∏è Hypoth√®ses</option>
                        <option value="error">üî¥ Non trait√©es</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Causes racines principales d√©fauts d√©tect√©s..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Recommandations actions correctives</div>
                        <div class="item-description">Actions prioris√©es : Urgentes (critique), Court terme (<3 mois), Moyen terme (3-12 mois)</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ D√©finies</option>
                        <option value="warning">‚ö†Ô∏è Partielles</option>
                        <option value="error">üî¥ Absentes</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Actions correctives recommand√©es par priorit√©..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Conformit√© normes v√©rifi√©e</div>
                        <div class="item-description">Conformit√© IEC 62446-1, NF C 15-100, UTE C 15-712-1, DTU 40.35 √©valu√©e</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Conforme</option>
                        <option value="warning">‚ö†Ô∏è Non-conformit√©s mineures</option>
                        <option value="error">üî¥ Non-conformit√©s majeures</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Non-conformit√©s d√©tect√©es, articles normes concern√©s..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Coh√©rence DOE vs terrain</div>
                        <div class="item-description">V√©rification plans calepinage, sch√©mas √©lectriques, puissances vs r√©alit√© terrain</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Coh√©rent</option>
                        <option value="warning">‚ö†Ô∏è √âcarts mineurs</option>
                        <option value="error">üî¥ Incoh√©rences majeures</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Incoh√©rences DOE/terrain d√©tect√©es (modifications non document√©es...)"></textarea>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Benchmarking performance centrale</div>
                        <div class="item-description">Comparaison PR vs centrales similaires (r√©gion, puissance, technologie, √¢ge)</div>
                        <input type="text" class="item-input" placeholder="PR centrale (%), PR benchmark (%), position relative...">
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Au-dessus moyenne</option>
                        <option value="warning">‚ö†Ô∏è Moyenne</option>
                        <option value="error">üî¥ Sous moyenne</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="4">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Potentiel optimisation identifi√©</div>
                        <div class="item-description">Repowering, nettoyage, remplacement modules d√©fectueux, optimisations exploitation</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Identifi√©</option>
                        <option value="warning">‚ö†Ô∏è Potentiel limit√©</option>
                        <option value="na">N/A (centrale neuve)</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Potentiel optimisation (gain prod estim√©, ROI, priorit√©s)..."></textarea>
            </div>
        </div>
        
        <!-- SECTION 5: PR√âPARATION LIVRABLES CLIENT -->
        <div class="section">
            <div class="section-header">
                <div class="section-icon">üìÑ</div>
                <div class="section-title">
                    <h2>5. PR√âPARATION LIVRABLES CLIENT (10 min)</h2>
                    <p>G√©n√©ration rapport, synth√®se ex√©cutive, validation finale</p>
                </div>
                <div class="section-progress" data-section="5">0/7</div>
            </div>
            
            <div class="checklist-item" data-section="5">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Rapport PDF g√©n√©r√© branded DiagPV</div>
                        <div class="item-description">G√©n√©ration rapport automatique depuis webapp, identit√© DiagPV appliqu√©e, structure conforme</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ G√©n√©r√©</option>
                        <option value="warning">‚ö†Ô∏è Corrections n√©cessaires</option>
                        <option value="error">üî¥ Non g√©n√©r√©</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="5">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Synth√®se ex√©cutive r√©dig√©e</div>
                        <div class="item-description">R√©sum√© 1 page : √âtat g√©n√©ral, d√©fauts majeurs, recommandations prioritaires, conclusion</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ R√©dig√©e</option>
                        <option value="warning">‚ö†Ô∏è √Ä compl√©ter</option>
                        <option value="error">üî¥ Absente</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Synth√®se ex√©cutive brute (copier-coller rapport)..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="5">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Cartographie anomalies g√©olocalis√©es</div>
                        <div class="item-description">Plan site avec overlay d√©fauts g√©olocalis√©s (thermographie, EL), l√©gende claire</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Cr√©√©e</option>
                        <option value="warning">‚ö†Ô∏è Partielle</option>
                        <option value="error">üî¥ Absente</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="5">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Annexes techniques compl√®tes</div>
                        <div class="item-description">Tableaux mesures, graphiques, m√©thodologie, r√©f√©rences normes, photos repr√©sentatives</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Compl√®tes</option>
                        <option value="warning">‚ö†Ô∏è Partielles</option>
                        <option value="error">üî¥ Absentes</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item" data-section="5">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Relecture orthographe/coh√©rence</div>
                        <div class="item-description">Correction fautes, v√©rification coh√©rence donn√©es rapport, terminologie pr√©cise</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Relu</option>
                        <option value="warning">‚ö†Ô∏è Relecture rapide</option>
                        <option value="error">üî¥ Non relu</option>
                    </select>
                </div>
            </div>
            
            <div class="checklist-item critical" data-section="5">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Validation Fabien CORRERA obtenue <span class="item-badge badge-critical">CRITIQUE</span></div>
                        <div class="item-description">Relecture expert technique DiagPV, signature √©lectronique/physique rapport, autorisation envoi</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ Valid√©</option>
                        <option value="warning">‚ö†Ô∏è Corrections demand√©es</option>
                        <option value="error">üî¥ Refus√©</option>
                    </select>
                </div>
                <textarea class="item-notes" placeholder="Retours Fabien, corrections apport√©es..."></textarea>
            </div>
            
            <div class="checklist-item" data-section="5">
                <div class="item-header">
                    <input type="checkbox" class="item-checkbox">
                    <div class="item-content">
                        <div class="item-title">Email transmission client r√©dig√©</div>
                        <div class="item-description">Email professionnel, r√©sum√© intervention, pi√®ces jointes list√©es, disponibilit√© √©changes</div>
                    </div>
                    <select class="item-status">
                        <option value="">-- Statut --</option>
                        <option value="ok">‚úÖ R√©dig√©</option>
                        <option value="warning">‚ö†Ô∏è √Ä finaliser</option>
                        <option value="error">üî¥ Non r√©dig√©</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- Actions Finales -->
        <div class="actions">
            <button class="btn btn-success" onclick="validateControl()">‚úÖ Valider Contr√¥le (Conforme)</button>
            <button class="btn btn-warning" onclick="requestCorrections()">‚ö†Ô∏è Demander Corrections</button>
            <button class="btn btn-primary" onclick="exportJSON()">üì• Exporter JSON</button>
            <button class="btn btn-secondary" onclick="generateReport()">üìÑ G√©n√©rer Rapport BE</button>
            <button class="btn btn-secondary" onclick="window.print()">üñ®Ô∏è Imprimer</button>
        </div>
        
        <!-- Footer -->
        <div class="footer">
            <p><strong>Diagnostic Photovolta√Øque - Bureau d'√âtudes</strong></p>
            <p>3 rue d'Apollo, 31240 L'Union | ‚òéÔ∏è 05.81.10.16.59 | üìß contact@diagpv.fr</p>
            <p style="margin-top: 10px; font-size: 11px;">RCS Toulouse 792 972 309 | Assurance RC Pro MMA</p>
            <p style="margin-top: 8px; opacity: 0.8;">Checklist BE V2.0 | Mission GIRASOLE 2025 | ¬© DiagPV 2025</p>
        </div>
    </div>
    
    <script>
        // Fonction mise √† jour progression
        function updateProgress() {
            const sections = [1, 2, 3, 4, 5];
            let totalChecked = 0;
            let totalItems = 0;
            let nbOK = 0;
            let nbWarning = 0;
            let nbError = 0;
            
            sections.forEach(section => {
                const sectionItems = document.querySelectorAll(`.checklist-item[data-section="${section}"]`);
                const sectionCheckboxes = Array.from(sectionItems).map(item => item.querySelector('.item-checkbox'));
                const checked = sectionCheckboxes.filter(cb => cb.checked).length;
                const total = sectionCheckboxes.length;
                
                const progressDisplay = document.querySelector(`.section-progress[data-section="${section}"]`);
                if (progressDisplay) {
                    progressDisplay.textContent = `${checked}/${total}`;
                }
                
                totalChecked += checked;
                totalItems += total;
                
                // Compter statuts
                sectionItems.forEach(item => {
                    const status = item.querySelector('.item-status');
                    if (status && status.value) {
                        if (status.value === 'ok') nbOK++;
                        else if (status.value === 'warning') nbWarning++;
                        else if (status.value === 'error') nbError++;
                    }
                });
            });
            
            const percentage = totalItems > 0 ? Math.round((totalChecked / totalItems) * 100) : 0;
            document.getElementById('globalProgress').style.width = percentage + '%';
            document.getElementById('globalProgressText').textContent = `${totalChecked}/${totalItems} (${percentage}%)`;
            
            // Mise √† jour r√©sum√© statut
            document.getElementById('nbConformes').textContent = nbOK;
            document.getElementById('nbAvertissements').textContent = nbWarning;
            document.getElementById('nbErreurs').textContent = nbError;
            document.getElementById('tauxCompletude').textContent = percentage + '%';
        }
        
        // Gestion checkboxes
        document.querySelectorAll('.item-checkbox').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const item = this.closest('.checklist-item');
                if (this.checked) {
                    item.classList.add('checked');
                } else {
                    item.classList.remove('checked');
                }
                updateProgress();
                saveLocal();
            });
        });
        
        // Gestion statuts
        document.querySelectorAll('.item-status').forEach(select => {
            select.addEventListener('change', function() {
                const item = this.closest('.checklist-item');
                item.classList.remove('warning', 'error');
                
                if (this.value === 'warning') {
                    item.classList.add('warning');
                } else if (this.value === 'error') {
                    item.classList.add('error');
                }
                
                updateProgress();
                saveLocal();
            });
        });
        
        // Gestion inputs
        document.querySelectorAll('input, select, textarea').forEach(input => {
            input.addEventListener('change', saveLocal);
        });
        
        // Validation contr√¥le
        function validateControl() {
            const nbErrors = parseInt(document.getElementById('nbErreurs').textContent);
            
            if (nbErrors > 0) {
                if (!confirm(`‚ö†Ô∏è Attention : ${nbErrors} r√©serve(s) majeure(s) d√©tect√©e(s).\n\nConfirmer validation CONFORME malgr√© tout ?`)) {
                    return;
                }
            }
            
            document.getElementById('statutValidation').value = 'conforme';
            alert('‚úÖ Contr√¥le valid√© CONFORME !\n\nRapport pr√™t pour envoi client.');
            saveLocal();
        }
        
        // Demander corrections
        function requestCorrections() {
            const nbWarnings = parseInt(document.getElementById('nbAvertissements').textContent);
            const nbErrors = parseInt(document.getElementById('nbErreurs').textContent);
            
            let message = '‚ö†Ô∏è CORRECTIONS N√âCESSAIRES\n\n';
            message += `R√©serves mineures : ${nbWarnings}\n`;
            message += `R√©serves majeures : ${nbErrors}\n\n`;
            message += 'Email envoy√© techniciens terrain avec d√©tails corrections.';
            
            alert(message);
            
            if (nbErrors > 0) {
                document.getElementById('statutValidation').value = 'reserve_majeure';
            } else {
                document.getElementById('statutValidation').value = 'reserve_mineure';
            }
            
            saveLocal();
        }
        
        // Export JSON
        function exportJSON() {
            const data = {
                mission: {
                    centrale: document.getElementById('centrale').value,
                    dateIntervention: document.getElementById('dateIntervention').value,
                    techniciens: document.getElementById('techniciens').value,
                    validateur: document.getElementById('validateur').value,
                    dateControle: document.getElementById('dateControle').value,
                    statutValidation: document.getElementById('statutValidation').value
                },
                checklist: {},
                summary: {
                    conformes: document.getElementById('nbConformes').textContent,
                    avertissements: document.getElementById('nbAvertissements').textContent,
                    erreurs: document.getElementById('nbErreurs').textContent,
                    completude: document.getElementById('tauxCompletude').textContent
                }
            };
            
            document.querySelectorAll('.checklist-item').forEach((item, index) => {
                const checkbox = item.querySelector('.item-checkbox');
                const status = item.querySelector('.item-status');
                const title = item.querySelector('.item-title').textContent.trim();
                const notes = item.querySelector('.item-notes');
                const input = item.querySelector('.item-input');
                
                data.checklist[`item_${index}`] = {
                    title: title,
                    checked: checkbox.checked,
                    status: status ? status.value : '',
                    notes: notes ? notes.value : '',
                    input: input ? input.value : ''
                };
            });
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `checklist_BE_${data.mission.centrale}_${data.mission.dateControle}.json`;
            a.click();
            
            alert('‚úÖ Export JSON contr√¥le BE r√©ussi !');
        }
        
        // G√©n√©ration rapport
        function generateReport() {
            alert('üìÑ G√©n√©ration rapport BE : √Ä impl√©menter\n\nFonctionnalit√©s futures :\n- Synth√®se automatique contr√¥le\n- Tableau anomalies d√©tect√©es\n- Recommandations corrections\n- Export Word/PDF');
        }
        
        // Sauvegarde locale
        function saveLocal() {
            const data = {
                mission: {
                    centrale: document.getElementById('centrale').value,
                    dateIntervention: document.getElementById('dateIntervention').value,
                    techniciens: document.getElementById('techniciens').value,
                    validateur: document.getElementById('validateur').value,
                    dateControle: document.getElementById('dateControle').value,
                    statutValidation: document.getElementById('statutValidation').value
                },
                checkboxes: [],
                statuses: [],
                notes: [],
                inputs: []
            };
            
            document.querySelectorAll('.item-checkbox').forEach((cb, i) => {
                data.checkboxes[i] = cb.checked;
            });
            
            document.querySelectorAll('.item-status').forEach((status, i) => {
                data.statuses[i] = status.value;
            });
            
            document.querySelectorAll('.item-notes').forEach((note, i) => {
                data.notes[i] = note.value;
            });
            
            document.querySelectorAll('.item-input').forEach((input, i) => {
                data.inputs[i] = input.value;
            });
            
            localStorage.setItem('checklistBE', JSON.stringify(data));
        }
        
        // Chargement sauvegarde
        function loadLocal() {
            const saved = localStorage.getItem('checklistBE');
            if (saved) {
                const data = JSON.parse(saved);
                
                if (data.mission) {
                    document.getElementById('centrale').value = data.mission.centrale || '';
                    document.getElementById('dateIntervention').value = data.mission.dateIntervention || '';
                    document.getElementById('techniciens').value = data.mission.techniciens || '';
                    document.getElementById('validateur').value = data.mission.validateur || '';
                    document.getElementById('dateControle').value = data.mission.dateControle || '';
                    document.getElementById('statutValidation').value = data.mission.statutValidation || '';
                }
                
                if (data.checkboxes) {
                    document.querySelectorAll('.item-checkbox').forEach((cb, i) => {
                        if (data.checkboxes[i]) {
                            cb.checked = true;
                            cb.closest('.checklist-item').classList.add('checked');
                        }
                    });
                }
                
                if (data.statuses) {
                    document.querySelectorAll('.item-status').forEach((status, i) => {
                        if (data.statuses[i]) {
                            status.value = data.statuses[i];
                            const item = status.closest('.checklist-item');
                            if (data.statuses[i] === 'warning') item.classList.add('warning');
                            else if (data.statuses[i] === 'error') item.classList.add('error');
                        }
                    });
                }
                
                if (data.notes) {
                    document.querySelectorAll('.item-notes').forEach((note, i) => {
                        note.value = data.notes[i] || '';
                    });
                }
                
                if (data.inputs) {
                    document.querySelectorAll('.item-input').forEach((input, i) => {
                        input.value = data.inputs[i] || '';
                    });
                }
                
                updateProgress();
            }
        }
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            loadLocal();
            updateProgress();
            
            // Date contr√¥le par d√©faut
            if (!document.getElementById('dateControle').value) {
                document.getElementById('dateControle').value = new Date().toISOString().split('T')[0];
            }
        });
    </script>
</body>
</html>