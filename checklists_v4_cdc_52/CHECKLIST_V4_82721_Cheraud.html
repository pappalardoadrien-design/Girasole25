<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Audit V4 - Cheraud</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px;
            line-height: 1.6;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }
        .header h1 { font-size: 24px; margin-bottom: 8px; }
        .header .version { 
            background: rgba(255,255,255,0.2);
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            margin-top: 5px;
        }
        .centrale-info {
            background: rgba(255,255,255,0.15);
            padding: 12px;
            border-radius: 8px;
            margin-top: 10px;
            text-align: left;
            font-size: 13px;
        }
        .centrale-info p { margin: 4px 0; }
        
        .section {
            padding: 20px;
            border-bottom: 2px solid #e9ecef;
        }
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
            border-radius: 8px;
            font-size: 18px;
            font-weight: bold;
        }
        .section-header.new {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }
        .section-header .badge {
            background: rgba(255,255,255,0.3);
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 11px;
        }
        
        .subsection {
            background: #e8f5e9;
            padding: 12px;
            margin: 15px 0;
            border-left: 4px solid #4caf50;
            border-radius: 6px;
        }
        .subsection-title {
            font-weight: bold;
            color: #2e7d32;
            margin-bottom: 10px;
            font-size: 15px;
        }
        
        .question {
            background: #f8f9fa;
            padding: 15px;
            margin-bottom: 12px;
            border-radius: 8px;
            border-left: 4px solid #2ecc71;
        }
        .question.required {
            border-left-color: #e74c3c;
        }
        .question label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #2c3e50;
        }
        .question label .norm {
            color: #3498db;
            font-size: 11px;
            font-weight: normal;
            background: #e3f2fd;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: 5px;
        }
        .question input[type="text"],
        .question input[type="number"],
        .question textarea,
        .question select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .question textarea {
            min-height: 80px;
            resize: vertical;
        }
        
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            background: white;
            padding: 10px;
            border-radius: 6px;
            border: 2px solid #e9ecef;
        }
        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }
        .checkbox-item label {
            margin: 0;
            font-weight: normal;
            cursor: pointer;
        }
        
        /* PHOTOS SECTION */
        .photo-section {
            background: #fff3cd;
            border: 3px dashed #ffc107;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        .photo-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }
        .photo-category {
            font-size: 18px;
            font-weight: bold;
            color: #856404;
        }
        .photo-count {
            background: #28a745;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        .photo-guide {
            background: white;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 12px;
            font-size: 13px;
            color: #666;
        }
        .photo-guide strong {
            color: #856404;
            display: block;
            margin-bottom: 5px;
        }
        .btn-photo {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #28a745 0%, #20803a 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        .btn-photo:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40,167,69,0.3);
        }
        .photo-preview {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }
        .photo-preview img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid #ddd;
            transition: all 0.3s;
        }
        .photo-preview img:hover {
            transform: scale(1.05);
            border-color: #28a745;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-size: 14px;
        }
        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid #0c5460;
            color: #0c5460;
        }
        .alert-success {
            background: #d4edda;
            border-left: 4px solid #155724;
            color: #155724;
        }
        .alert-warning {
            background: #fff3cd;
            border-left: 4px solid #856404;
            color: #856404;
        }
        
        .btn-export {
            width: 100%;
            padding: 20px;
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin: 20px 0;
        }
        .btn-export:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,123,255,0.3);
        }
        
        .footer {
            background: #2c3e50;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 12px;
        }
        .footer p { margin: 5px 0; }
        
        input[type="file"] {
            display: none;
        }
        
        .progress-bar {
            background: #e9ecef;
            height: 30px;
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }
        .progress-fill {
            background: linear-gradient(135deg, #28a745 0%, #20803a 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- HEADER -->
        <div class="header">
            <h1>üìã CHECKLIST AUDIT PV - CONFORME CDC GIRASOLE</h1>
            <div class="version">Version 4.0 - Conformit√© CDC 100%</div>
            <p>Diagnostic Photovolta√Øque - Mission GIRASOLE 2025</p>
            <div class="centrale-info">
                <p><strong>üè≠ Centrale :</strong> 82721 - Cheraud</p>
                <p><strong>‚ö° Puissance :</strong> 499.59 kWc</p>
                <p><strong>üìç Adresse :</strong> Bellevue, 44260 Malville, France</p>
                <p><strong>üè∑Ô∏è Type :</strong> SOL</p>
            </div>
        </div>

        <!-- BARRE PROGRESSION -->
        <div class="section">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0% compl√©t√©</div>
            </div>
            <div class="alert alert-info">
                <strong>üìä Conformit√© CDC GIRASOLE</strong><br>
                Cette checklist V4 couvre les 54 points techniques requis par le CDC PERF-CDC-001 :<br>
                ‚Ä¢ 4 Prescriptions documentaires GIRASOLE<br>
                ‚Ä¢ 25 Points conformit√© √©lectrique (NF C 15-100 / UTE C 15-712-1)<br>
                ‚Ä¢ 2 Points tranch√©es AC<br>
                ‚Ä¢ 7 Points modules PV<br>
                ‚Ä¢ 5 Points structure support<br>
                ‚Ä¢ 4 Points bo√Ætes protection<br>
                ‚Ä¢ 13 Points audit toiture (si applicable)<br>
                ‚Ä¢ Photos min: 35-50 par centrale
            </div>
        </div>

        <!-- SECTION 1 : INFORMATIONS G√âN√âRALES -->
        <div class="section">
            <div class="section-header">
                <span>üìÖ 1. INFORMATIONS G√âN√âRALES</span>
            </div>
            
            <div class="question required">
                <label>Date intervention</label>
                <input type="date" id="date_intervention" required>
            </div>
            
            <div class="question required">
                <label>Heure d√©but</label>
                <input type="time" id="heure_debut" required>
            </div>
            
            <div class="question">
                <label>Heure fin</label>
                <input type="time" id="heure_fin">
            </div>
            
            <div class="question required">
                <label>Technicien (Nom + Pr√©nom)</label>
                <input type="text" id="technicien" placeholder="Ex: Dupont Jean" required>
            </div>
            
            <div class="question">
                <label>M√©t√©o</label>
                <select id="meteo">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Ensoleill√©">‚òÄÔ∏è Ensoleill√©</option>
                    <option value="Nuageux">‚òÅÔ∏è Nuageux</option>
                    <option value="Pluvieux">üåßÔ∏è Pluvieux</option>
                    <option value="Venteux">üí® Venteux</option>
                </select>
            </div>
            
            <div class="question">
                <label>Temp√©rature (¬∞C)</label>
                <input type="number" id="temperature" placeholder="Ex: 25">
            </div>
        </div>

        <!-- SECTION 2 : PRESCRIPTIONS DOCUMENTAIRES GIRASOLE (NOUVEAU CDC) -->
        <div class="section">
            <div class="section-header new">
                <span>üìÑ 2. PRESCRIPTIONS DOCUMENTAIRES GIRASOLE</span>
                <span class="badge">üÜï CDC ¬ß2.4</span>
            </div>
            
            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è EXIGENCE CDC :</strong> V√©rifier pr√©sence et conformit√© des documents exig√©s par GIRASOLE
            </div>
            
            <div class="question required">
                <label>Autocontr√¥le installateur <span class="norm">CDC GIRASOLE</span></label>
                <select id="doc_autocontrole" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Pr√©sent et correctement renseign√©">‚úÖ Pr√©sent et correctement renseign√©</option>
                    <option value="Pr√©sent mais incomplet">‚ö†Ô∏è Pr√©sent mais incomplet</option>
                    <option value="Absent">‚ùå Absent</option>
                </select>
            </div>
            
            <div class="question required">
                <label>PV de r√©ception du lot PV <span class="norm">CDC GIRASOLE</span></label>
                <select id="doc_pv_reception" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Pr√©sent sign√© GIRASOLE + installateur">‚úÖ Pr√©sent sign√© GIRASOLE + installateur</option>
                    <option value="Pr√©sent mais non sign√©">‚ö†Ô∏è Pr√©sent mais non sign√©</option>
                    <option value="Absent">‚ùå Absent</option>
                </select>
            </div>
            
            <div class="question required">
                <label>CR visite chantier GIRASOLE (minimum 1) <span class="norm">CDC GIRASOLE</span></label>
                <select id="doc_cr_chantier" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Pr√©sent (1 ou +)">‚úÖ Pr√©sent (1 ou plus)</option>
                    <option value="Absent">‚ùå Absent</option>
                </select>
            </div>
            
            <div class="question required">
                <label>Cahier des charges tranch√©es fourni au bailleur <span class="norm">CDC GIRASOLE</span></label>
                <select id="doc_cdc_tranchees" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Pr√©sent">‚úÖ Pr√©sent</option>
                    <option value="Absent">‚ùå Absent</option>
                    <option value="Non applicable">N/A - Non applicable</option>
                </select>
            </div>
            
            <div class="question required">
                <label>Plans TQC (Tel Que Construit) pr√©sents sur place <span class="norm">CDC ¬ß2.5</span></label>
                <select id="doc_plans_tqc" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Pr√©sents sur site">‚úÖ Pr√©sents sur site</option>
                    <option value="Absents du site">‚ùå Absents du site</option>
                </select>
            </div>
            
            <div class="question">
                <label>Autres documents consult√©s</label>
                <textarea id="doc_autres" placeholder="Sch√©mas √©lectriques, attestations DRE, notices fabricants..."></textarea>
            </div>
            
            <!-- PHOTOS DOCUMENTS -->
            <div class="photo-section">
                <div class="photo-header">
                    <span class="photo-category">üì∏ PHOTOS DOCUMENTS (DOC)</span>
                    <span class="photo-count" id="count_DOC">0 photos</span>
                </div>
                <div class="photo-guide">
                    <strong>üìã √Ä photographier (minimum 5 photos) :</strong>
                    ‚Ä¢ Autocontr√¥le installateur (toutes pages)<br>
                    ‚Ä¢ PV r√©ception lot PV (signatures visibles)<br>
                    ‚Ä¢ CR visite chantier GIRASOLE<br>
                    ‚Ä¢ CDC tranch√©es (si applicable)<br>
                    ‚Ä¢ Plans TQC (sch√©ma unifilaire, implantation)<br>
                    ‚Ä¢ Plaques signal√©tiques (onduleurs, modules)<br>
                    ‚Ä¢ Attestations DRE bureau contr√¥le
                </div>
                <input type="file" id="photo_DOC" accept="image/*" multiple capture="environment">
                <button class="btn-photo" onclick="document.getElementById('photo_DOC').click()">
                    üì∑ PRENDRE/AJOUTER PHOTOS DOCUMENTS
                </button>
                <div class="photo-preview" id="preview_DOC"></div>
            </div>
        </div>

        <!-- SECTION 3 : CONFORMIT√â √âLECTRIQUE D√âTAILL√âE (NOUVEAU CDC) -->
        <div class="section">
            <div class="section-header new">
                <span>‚ö° 3. CONFORMIT√â √âLECTRIQUE D√âTAILL√âE</span>
                <span class="badge">üÜï NF C 15-100 / UTE C 15-712-1</span>
            </div>
            
            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è EXIGENCE CDC ¬ß2.2 + ¬ß2.5 :</strong> V√©rification conformit√© normes √©lectriques + bonnes/mauvaises pratiques
            </div>
            
            <!-- 3.1 AGCP -->
            <div class="subsection">
                <div class="subsection-title">3.1 AGCP (Appareil G√©n√©ral de Coupure et Protection)</div>
                
                <div class="question required">
                    <label>√âtat g√©n√©ral AGCP <span class="norm">NF C 15-100</span></label>
                    <select id="agcp_etat" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Conforme">‚úÖ Conforme</option>
                        <option value="Non conforme">‚ùå Non conforme</option>
                        <option value="√Ä v√©rifier">‚ö†Ô∏è √Ä v√©rifier</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>R√©glages AGCP conformes aux plans <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="agcp_reglages" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Conformes aux plans">‚úÖ Conformes aux plans</option>
                        <option value="Non conformes aux plans">‚ùå Non conformes aux plans</option>
                        <option value="Plans non disponibles">‚ö†Ô∏è Plans non disponibles</option>
                    </select>
                </div>
                
                <div class="question">
                    <label>√âtiquetage r√©glementaire AGCP <span class="norm">NF C 15-100</span></label>
                    <select id="agcp_etiquetage">
                        <option value="">-- S√©lectionner --</option>
                        <option value="Pr√©sent et conforme">‚úÖ Pr√©sent et conforme</option>
                        <option value="Pr√©sent mais incomplet">‚ö†Ô∏è Pr√©sent mais incomplet</option>
                        <option value="Absent">‚ùå Absent</option>
                    </select>
                </div>
            </div>
            
            <!-- 3.2 ONDULEURS -->
            <div class="subsection">
                <div class="subsection-title">3.2 Onduleurs</div>
                
                <div class="question required">
                    <label>Onduleurs fonctionnels <span class="norm">UTE C 15-712-1</span></label>
                    <select id="onduleurs_fonctionnels" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Tous fonctionnels">‚úÖ Tous fonctionnels</option>
                        <option value="D√©faillances d√©tect√©es">‚ùå D√©faillances d√©tect√©es</option>
                        <option value="Certains d√©fauts">‚ö†Ô∏è Certains d√©fauts mineurs</option>
                    </select>
                </div>
                
                <div class="question">
                    <label>Nombre onduleurs</label>
                    <input type="number" id="onduleurs_nombre" placeholder="Ex: 2">
                </div>
                
                <div class="question">
                    <label>Marque/mod√®le onduleurs</label>
                    <input type="text" id="onduleurs_modele" placeholder="Ex: Fronius Symo 20.0-3">
                </div>
                
                <div class="question required">
                    <label>C√¢blage DC/AC onduleurs <span class="norm">UTE C 15-712-1</span></label>
                    <select id="onduleurs_cablage" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Conforme">‚úÖ Conforme</option>
                        <option value="Non conforme">‚ùå Non conforme</option>
                    </select>
                </div>
                
                <div class="question">
                    <label>Rep√©rage √©quipements (onduleurs) <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="onduleurs_reperage">
                        <option value="">-- S√©lectionner --</option>
                        <option value="Pr√©sent sur √©quipement">‚úÖ Pr√©sent sur √©quipement</option>
                        <option value="Pr√©sent mais non sur √©quipement">‚ö†Ô∏è Pr√©sent mais non sur √©quipement</option>
                        <option value="Absent">‚ùå Absent</option>
                    </select>
                </div>
            </div>
            
            <!-- 3.3 C√ÇBLAGE ET CHEMINEMENTS -->
            <div class="subsection">
                <div class="subsection-title">3.3 C√¢blage et Cheminements</div>
                
                <div class="question required">
                    <label>Type cheminement c√¢bles <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="cablage_type_cheminement" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Galvanis√© √† chaud">‚úÖ Galvanis√© √† chaud</option>
                        <option value="Galvanis√© √† froid">‚ö†Ô∏è Galvanis√© √† froid</option>
                        <option value="Autre">üîπ Autre (pr√©ciser en commentaire)</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>M√©thode fixation chemin de c√¢bles <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="cablage_fixation_methode" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Ad√©quate et de qualit√©">‚úÖ Ad√©quate et de qualit√©</option>
                        <option value="Ad√©quate mais qualit√© moyenne">‚ö†Ô∏è Ad√©quate mais qualit√© moyenne</option>
                        <option value="Inad√©quate">‚ùå Inad√©quate</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Type rep√©rage c√¢bles <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="cablage_type_reperage" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="S√©rigraphi√©">‚úÖ S√©rigraphi√© (best practice)</option>
                        <option value="Tenant-aboutissant">‚úÖ Tenant-aboutissant</option>
                        <option value="Manuscrit">‚ö†Ô∏è Manuscrit</option>
                        <option value="Absent">‚ùå Absent</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Couleurs c√¢bles DC (+ / -) <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="cablage_couleurs_dc" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Diff√©rentes (+/-)">‚úÖ Diff√©rentes (+/-)</option>
                        <option value="Identiques (non conforme)">‚ùå Identiques (NON CONFORME)</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Rayons de courbure AC <span class="norm">CDC ¬ß2.5 / NF C 15-100</span></label>
                    <select id="cablage_courbure_ac" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Conformes">‚úÖ Conformes</option>
                        <option value="Non conformes">‚ùå Non conformes</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Rayons de courbure DC <span class="norm">CDC ¬ß2.5 / UTE C 15-712-1</span></label>
                    <select id="cablage_courbure_dc" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Conformes">‚úÖ Conformes</option>
                        <option value="Non conformes">‚ùå Non conformes</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Qualit√© brassage c√¢bles <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="cablage_brassage" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Bon">‚úÖ Bon</option>
                        <option value="Moyen">‚ö†Ô∏è Moyen</option>
                        <option value="Mauvais">‚ùå Mauvais</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Rep√©rage serrage connexions AC <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="cablage_reperage_serrage" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Pr√©sent">‚úÖ Pr√©sent</option>
                        <option value="Absent">‚ùå Absent</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Protections m√©caniques c√¢bles (bords saillants) <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="cablage_protections" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Pr√©sentes">‚úÖ Pr√©sentes</option>
                        <option value="Absentes">‚ùå Absentes</option>
                        <option value="Non applicable">N/A - Non applicable</option>
                    </select>
                </div>
            </div>
            
            <!-- 3.4 TERRES ET COSSES -->
            <div class="subsection">
                <div class="subsection-title">3.4 Terres et Cosses</div>
                
                <div class="question required">
                    <label>Cosses bim√©tal (jonction Cu/Al) <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="terres_cosses_bimetal" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Pr√©sentes">‚úÖ Pr√©sentes</option>
                        <option value="Absentes">‚ùå Absentes</option>
                        <option value="Non applicable">N/A - Pas de jonction Cu/Al</option>
                    </select>
                </div>
                
                <div class="question required">
                    <label>Cheminement terre le long chemins de c√¢bles <span class="norm">CDC ¬ß2.5</span></label>
                    <select id="terres_cheminement_type" required>
                        <option value="">-- S√©lectionner --</option>
                        <option value="Crapaud">‚úÖ Crapaud</option>
                        <option value="Bornier laiton">‚úÖ Bornier laiton</option>
                        <option value="Autre">üîπ Autre (pr√©ciser)</option>
                        <option value="Non conforme">‚ùå Non conforme</option>
                    </select>
                </div>
                
                <div class="question">
                    <label>Qualit√© fixation terre</label>
                    <select id="terres_fixation">
                        <option value="">-- S√©lectionner --</option>
                        <option value="Conforme">‚úÖ Conforme</option>
                        <option value="Non conforme">‚ùå Non conforme</option>
                    </select>
                </div>
            </div>
            
            <div class="question">
                <label>Observations conformit√© √©lectrique</label>
                <textarea id="elec_observations" placeholder="Constats g√©n√©raux, points d'attention, non-conformit√©s d√©tect√©es..."></textarea>
            </div>
            
            <!-- PHOTOS √âLECTRIQUE -->
            <div class="photo-section">
                <div class="photo-header">
                    <span class="photo-category">üì∏ PHOTOS √âLECTRIQUE (ELEC)</span>
                    <span class="photo-count" id="count_ELEC">0 photos</span>
                </div>
                <div class="photo-guide">
                    <strong>üìã √Ä photographier (minimum 10 photos) :</strong>
                    ‚Ä¢ AGCP complet (vue d'ensemble + d√©tails r√©glages)<br>
                    ‚Ä¢ √âtiquetage AGCP<br>
                    ‚Ä¢ Chaque onduleur (fa√ßade + √©cran √©tat + plaque)<br>
                    ‚Ä¢ Tableaux √©lectriques AC<br>
                    ‚Ä¢ Chemins de c√¢bles (type, fixations, brassage)<br>
                    ‚Ä¢ C√¢blage DC/AC (couleurs, rep√©rage, courbures)<br>
                    ‚Ä¢ Protections m√©caniques c√¢bles<br>
                    ‚Ä¢ Cheminement terre (crapauds/borniers)<br>
                    ‚Ä¢ Cosses bim√©tal (si applicable)<br>
                    ‚Ä¢ Dispositifs protection (parafoudres, sectionneurs)
                </div>
                <input type="file" id="photo_ELEC" accept="image/*" multiple capture="environment">
                <button class="btn-photo" onclick="document.getElementById('photo_ELEC').click()">
                    üì∑ PRENDRE/AJOUTER PHOTOS √âLECTRIQUE
                </button>
                <div class="photo-preview" id="preview_ELEC"></div>
            </div>
        </div>

        <!-- SECTION 4 : TRANCH√âES AC (NOUVEAU CDC) -->
        <div class="section">
            <div class="section-header new">
                <span>üöß 4. TRANCH√âES AC (Shelter ‚Üí PDL)</span>
                <span class="badge">üÜï CDC ¬ß2.5</span>
            </div>
            
            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è EXIGENCE CDC ¬ß2.5 :</strong> V√©rifier respect pr√©conisations tranch√©es AC et qualit√© rebouchage fourreaux
            </div>
            
            <div class="question required">
                <label>Tranch√©e AC accessible pour contr√¥le <span class="norm">CDC ¬ß2.5</span></label>
                <select id="tranchees_accessible" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Oui - contr√¥le effectu√©">‚úÖ Oui - contr√¥le effectu√©</option>
                    <option value="Non - tranch√©e enterr√©e">‚ö†Ô∏è Non - tranch√©e enterr√©e</option>
                    <option value="Partiellement accessible">‚ö†Ô∏è Partiellement accessible</option>
                </select>
            </div>
            
            <div class="question">
                <label>Respect pr√©conisations CDC tranch√©es (profondeur, TPC) <span class="norm">CDC ¬ß2.5</span></label>
                <select id="tranchees_respect_cdc">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Conforme CDC bailleur">‚úÖ Conforme CDC bailleur</option>
                    <option value="Non conforme">‚ùå Non conforme</option>
                    <option value="CDC non disponible">‚ö†Ô∏è CDC non disponible</option>
                    <option value="Non v√©rifiable">N/A - Non v√©rifiable (enterr√©)</option>
                </select>
            </div>
            
            <div class="question required">
                <label>Rebouchage entr√©e/sortie fourreaux <span class="norm">CDC ¬ß2.5</span></label>
                <select id="tranchees_rebouchage" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Conforme - rebouchage correct">‚úÖ Conforme - rebouchage correct</option>
                    <option value="Non conforme - absence rebouchage">‚ùå Non conforme - absence rebouchage</option>
                    <option value="Non conforme - rebouchage partiel">‚ö†Ô∏è Non conforme - rebouchage partiel</option>
                </select>
            </div>
            
            <div class="question">
                <label>Mat√©riaux rebouchage utilis√©s <span class="norm">CDC ¬ß2.5</span></label>
                <input type="text" id="tranchees_materiaux" placeholder="Ex: Mousse expansive, mastic, etc.">
            </div>
            
            <div class="question">
                <label>Observations tranch√©es AC</label>
                <textarea id="tranchees_observations" placeholder="Constats g√©n√©raux, non-conformit√©s, points d'attention..."></textarea>
            </div>
            
            <!-- PHOTOS TRANCH√âES -->
            <div class="photo-section">
                <div class="photo-header">
                    <span class="photo-category">üì∏ PHOTOS TRANCH√âES (TRANCHEES)</span>
                    <span class="photo-count" id="count_TRANCHEES">0 photos</span>
                </div>
                <div class="photo-guide">
                    <strong>üìã √Ä photographier (si accessible) :</strong>
                    ‚Ä¢ Tranch√©e AC ouverte (profondeur, TPC)<br>
                    ‚Ä¢ Fourreaux entr√©e/sortie (shelter, PDL)<br>
                    ‚Ä¢ Rebouchage fourreaux (mat√©riaux)<br>
                    ‚Ä¢ Grillage avertisseur (si visible)<br>
                    ‚Ä¢ Protection m√©canique c√¢bles
                </div>
                <input type="file" id="photo_TRANCHEES" accept="image/*" multiple capture="environment">
                <button class="btn-photo" onclick="document.getElementById('photo_TRANCHEES').click()">
                    üì∑ PRENDRE/AJOUTER PHOTOS TRANCH√âES
                </button>
                <div class="photo-preview" id="preview_TRANCHEES"></div>
            </div>
        </div>

        <!-- SECTION 5 : MODULES PV (AM√âLIOR√â CDC) -->
        <div class="section">
            <div class="section-header">
                <span>‚òÄÔ∏è 5. MODULES PHOTOVOLTA√èQUES</span>
                <span class="badge">‚ö†Ô∏è Am√©lior√© CDC</span>
            </div>
            
            <div class="question required">
                <label>√âtat visuel g√©n√©ral modules <span class="norm">UTE C 15-712-1</span></label>
                <select id="modules_etat_general" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Bon √©tat">‚úÖ Bon √©tat</option>
                    <option value="√âtat moyen - d√©fauts mineurs">‚ö†Ô∏è √âtat moyen - d√©fauts mineurs</option>
                    <option value="Mauvais √©tat - d√©fauts majeurs">‚ùå Mauvais √©tat - d√©fauts majeurs</option>
                </select>
            </div>
            
            <div class="question required">
                <label>Alignement modules PV <span class="norm">CDC ¬ß2.5</span></label>
                <select id="modules_alignement" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Correct">‚úÖ Correct</option>
                    <option value="D√©fauts d'alignement">‚ùå D√©fauts d'alignement</option>
                </select>
            </div>
            
            <div class="question">
                <label>Salissures modules</label>
                <select id="modules_salissures">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Aucune">‚úÖ Aucune</option>
                    <option value="L√©g√®res">‚ö†Ô∏è L√©g√®res</option>
                    <option value="Importantes">‚ùå Importantes (impact production)</option>
                </select>
            </div>
            
            <div class="question">
                <label>Fissures modules</label>
                <select id="modules_fissures">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Aucune">‚úÖ Aucune</option>
                    <option value="Microfissures">‚ö†Ô∏è Microfissures</option>
                    <option value="Fissures majeures">‚ùå Fissures majeures</option>
                </select>
            </div>
            
            <div class="question">
                <label>D√©coloration modules</label>
                <select id="modules_decoloration">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Aucune">‚úÖ Aucune</option>
                    <option value="L√©g√®re">‚ö†Ô∏è L√©g√®re</option>
                    <option value="Importante">‚ùå Importante</option>
                </select>
            </div>
            
            <div class="question required">
                <label>Points chauds d√©tect√©s (thermographie) <span class="norm">UTE C 15-712-1</span></label>
                <select id="modules_points_chauds" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Non - pas de points chauds">‚úÖ Non - pas de points chauds</option>
                    <option value="Oui - points chauds d√©tect√©s">‚ùå Oui - points chauds d√©tect√©s</option>
                    <option value="Non effectu√©">‚ö†Ô∏è Non effectu√© (pas de thermographie)</option>
                </select>
            </div>
            
            <div class="question">
                <label>Plaques signal√©tiques modules lisibles <span class="norm">CDC ¬ß2.5</span></label>
                <select id="modules_plaques">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Oui - lisibles">‚úÖ Oui - lisibles</option>
                    <option value="Non - illisibles">‚ùå Non - illisibles</option>
                </select>
            </div>
            
            <div class="question">
                <label>D√©fauts d√©tect√©s (description d√©taill√©e)</label>
                <textarea id="modules_defauts" placeholder="Lister tous d√©fauts observ√©s avec localisation pr√©cise..."></textarea>
            </div>
            
            <!-- PHOTOS MODULES -->
            <div class="photo-section">
                <div class="photo-header">
                    <span class="photo-category">üì∏ PHOTOS MODULES (MP)</span>
                    <span class="photo-count" id="count_MP">0 photos</span>
                </div>
                <div class="photo-guide">
                    <strong>üìã √Ä photographier (minimum 10 photos) :</strong>
                    ‚Ä¢ Vue d'ensemble installation (plusieurs angles)<br>
                    ‚Ä¢ Alignement modules (vues perspective)<br>
                    ‚Ä¢ Modules avec salissures<br>
                    ‚Ä¢ Fissures (photos rapproch√©es)<br>
                    ‚Ä¢ D√©coloration (comparaison zones)<br>
                    ‚Ä¢ Points chauds thermographie (si d√©tect√©s)<br>
                    ‚Ä¢ Connecteurs MC4 (√©tat, √©tanch√©it√©)<br>
                    ‚Ä¢ Plaques signal√©tiques modules (marque, puissance, r√©f√©rence)<br>
                    ‚Ä¢ D√©fauts visuels sp√©cifiques
                </div>
                <input type="file" id="photo_MP" accept="image/*" multiple capture="environment">
                <button class="btn-photo" onclick="document.getElementById('photo_MP').click()">
                    üì∑ PRENDRE/AJOUTER PHOTOS MODULES
                </button>
                <div class="photo-preview" id="preview_MP"></div>
            </div>
        </div>

        <!-- SECTION 6 : STRUCTURE SUPPORT (AM√âLIOR√â CDC) -->
        <div class="section">
            <div class="section-header">
                <span>üèóÔ∏è 6. STRUCTURE & SUPPORT</span>
                <span class="badge">‚ö†Ô∏è Am√©lior√© CDC</span>
            </div>
            
            <div class="question required">
                <label>Type installation</label>
                <select id="structure_type" required>
                    <option value="Sol">üåæ Installation au sol</option>
                    <option value="Toiture inclin√©e">üè† Toiture inclin√©e</option>
                    <option value="Toiture plate">üè¢ Toiture plate</option>
                    <option value="Ombri√®re">üÖøÔ∏è Ombri√®re parking</option>
                </select>
            </div>
            
            <div class="question required">
                <label>√âtat structure porteuse <span class="norm">CDC ¬ß2.5</span></label>
                <select id="structure_etat" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Bon √©tat">‚úÖ Bon √©tat</option>
                    <option value="√âtat moyen - attention requise">‚ö†Ô∏è √âtat moyen - attention requise</option>
                    <option value="Mauvais √©tat - intervention n√©cessaire">‚ùå Mauvais √©tat - intervention n√©cessaire</option>
                </select>
            </div>
            
            <div class="question required">
                <label>Fixations et boulonnerie <span class="norm">CDC ¬ß2.5</span></label>
                <select id="structure_fixations" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Serr√©es - bon √©tat">‚úÖ Serr√©es - bon √©tat</option>
                    <option value="Desserr√©es">‚ùå Desserr√©es</option>
                    <option value="Corrosion d√©tect√©e">‚ö†Ô∏è Corrosion d√©tect√©e</option>
                </select>
            </div>
            
            <div class="question">
                <label>Corrosion structure</label>
                <select id="structure_corrosion">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Aucune">‚úÖ Aucune</option>
                    <option value="L√©g√®re - superficielle">‚ö†Ô∏è L√©g√®re - superficielle</option>
                    <option value="Importante - structurelle">‚ùå Importante - structurelle</option>
                </select>
            </div>
            
            <div class="question">
                <label>Observations structure</label>
                <textarea id="structure_observations" placeholder="√âtat g√©n√©ral, d√©formations, d√©fauts d√©tect√©s..."></textarea>
            </div>
            
            <!-- PHOTOS STRUCTURE -->
            <div class="photo-section">
                <div class="photo-header">
                    <span class="photo-category">üì∏ PHOTOS STRUCTURE (TOIT)</span>
                    <span class="photo-count" id="count_TOIT">0 photos</span>
                </div>
                <div class="photo-guide">
                    <strong>üìã √Ä photographier (minimum 5 photos) :</strong>
                    ‚Ä¢ Vue d'ensemble structure support<br>
                    ‚Ä¢ Fondations ou ancrages toiture<br>
                    ‚Ä¢ Rails et fixations modules<br>
                    ‚Ä¢ Boulonnerie (√©tat, serrage, corrosion)<br>
                    ‚Ä¢ D√©fauts structure (d√©formations, fissures, corrosion)<br>
                    ‚Ä¢ Jonctions et assemblages
                </div>
                <input type="file" id="photo_TOIT" accept="image/*" multiple capture="environment">
                <button class="btn-photo" onclick="document.getElementById('photo_TOIT').click()">
                    üì∑ PRENDRE/AJOUTER PHOTOS STRUCTURE
                </button>
                <div class="photo-preview" id="preview_TOIT"></div>
            </div>
        </div>

        <!-- SECTION 7 : BO√éTES PROTECTION (AM√âLIOR√â CDC) -->
        <div class="section">
            <div class="section-header">
                <span>üì¶ 7. BO√éTES DE PROTECTION</span>
                <span class="badge">‚ö†Ô∏è Am√©lior√© CDC</span>
            </div>
            
            <div class="question required">
                <label>Bo√Ætes de jonction accessibles <span class="norm">UTE C 15-712-1</span></label>
                <select id="boites_accessibles" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Toutes accessibles">‚úÖ Toutes accessibles</option>
                    <option value="Partiellement accessibles">‚ö†Ô∏è Partiellement accessibles</option>
                    <option value="Inaccessibles">‚ùå Inaccessibles</option>
                </select>
            </div>
            
            <div class="question required">
                <label>√âtanch√©it√© bo√Ætes <span class="norm">UTE C 15-712-1</span></label>
                <select id="boites_etancheite" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Bonne">‚úÖ Bonne</option>
                    <option value="Douteuse">‚ö†Ô∏è Douteuse</option>
                    <option value="D√©faillante">‚ùå D√©faillante</option>
                </select>
            </div>
            
            <div class="question required">
                <label>C√¢blage int√©rieur bo√Ætes <span class="norm">CDC ¬ß2.5</span></label>
                <select id="boites_cablage" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Correct">‚úÖ Correct</option>
                    <option value="D√©sordre">‚ö†Ô∏è D√©sordre</option>
                    <option value="Dangereux">‚ùå Dangereux</option>
                </select>
            </div>
            
            <div class="question required">
                <label>Serrage connexions <span class="norm">CDC ¬ß2.5</span></label>
                <select id="boites_serrage" required>
                    <option value="">-- S√©lectionner --</option>
                    <option value="Correct">‚úÖ Correct</option>
                    <option value="√Ä resserrer">‚ö†Ô∏è √Ä resserrer</option>
                </select>
            </div>
            
            <div class="question">
                <label>Observations bo√Ætes protection</label>
                <textarea id="boites_observations" placeholder="√âtat g√©n√©ral, d√©fauts, corrosion, propret√©..."></textarea>
            </div>
            
            <!-- PHOTOS BO√éTES -->
            <div class="photo-section">
                <div class="photo-header">
                    <span class="photo-category">üì∏ PHOTOS BO√éTES (BP)</span>
                    <span class="photo-count" id="count_BP">0 photos</span>
                </div>
                <div class="photo-guide">
                    <strong>üìã √Ä photographier (minimum 3 photos) :</strong>
                    ‚Ä¢ Chaque bo√Æte de jonction (ext√©rieur ferm√©)<br>
                    ‚Ä¢ Int√©rieur bo√Ætes (c√¢blage, connexions, fusibles)<br>
                    ‚Ä¢ √âtanch√©it√© (joints, presse-√©toupes)<br>
                    ‚Ä¢ D√©fauts d√©tect√©s (corrosion, infiltration)<br>
                    ‚Ä¢ Rep√©rage bo√Ætes
                </div>
                <input type="file" id="photo_BP" accept="image/*" multiple capture="environment">
                <button class="btn-photo" onclick="document.getElementById('photo_BP').click()">
                    üì∑ PRENDRE/AJOUTER PHOTOS BO√éTES
                </button>
                <div class="photo-preview" id="preview_BP"></div>
            </div>
        </div>

        <!-- SECTION 8 : AUDIT TOITURE SP√âCIFIQUE (NOUVEAU CDC - SI APPLICABLE) -->
        <div class="section" id="section_toiture" style="display: none;">
            <div class="section-header new">
                <span>üè† 8. AUDIT TOITURE SP√âCIFIQUE (si applicable)</span>
                <span class="badge">üÜï DTU 40.35 / ETN</span>
            </div>
            
            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è SECTION UNIQUEMENT SI CENTRALE AVEC "AUDIT TOITURE" (13 centrales)</strong><br>
                CDC ¬ß2.2 : V√©rification DTU 40.35, ETN, notices montage + d√©montage 25 panneaux minimum
            </div>
            
            <div class="question">
                <label>Cette centrale n√©cessite-t-elle un audit toiture ?</label>
                <select id="toiture_applicable" onchange="toggleToitureSection()">
                    <option value="Non">‚ùå Non - Installation SOL (ignorer cette section)</option>
                    <option value="Oui">‚úÖ Oui - Audit toiture requis (compl√©ter ci-dessous)</option>
                </select>
            </div>
            
            <div id="toiture_details" style="display: none;">
                <!-- 8.1 PR√âPARATION -->
                <div class="subsection">
                    <div class="subsection-title">8.1 Pr√©paration Audit Toiture</div>
                    
                    <div class="question required">
                        <label>D√©montage panneaux effectu√© <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_demontage">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui - 25 panneaux ou plus">‚úÖ Oui - 25 panneaux ou plus</option>
                            <option value="Oui - moins de 25 panneaux">‚ö†Ô∏è Oui - moins de 25 panneaux</option>
                            <option value="Non effectu√©">‚ùå Non effectu√©</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <label>Nombre panneaux d√©mont√©s</label>
                        <input type="number" id="toiture_nb_panneaux" placeholder="Ex: 25">
                    </div>
                    
                    <div class="question">
                        <label>Panneaux choix pertinent (1er/dernier cha√Æne) <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_choix_pertinent">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui - choix pertinent">‚úÖ Oui - choix pertinent</option>
                            <option value="Non - choix non optimal">‚ö†Ô∏è Non - choix non optimal</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Interdiction marche sur panneaux respect√©e <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_marche_interdite" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui - respect√©e">‚úÖ Oui - respect√©e</option>
                            <option value="Non - non respect√©e">‚ùå Non - non respect√©e</option>
                        </select>
                    </div>
                </div>
                
                <!-- 8.2 SYST√àME INT√âGRATION -->
                <div class="subsection">
                    <div class="subsection-title">8.2 Syst√®me Int√©gration (SI)</div>
                    
                    <div class="question required">
                        <label>Montage SI sur support <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_si_montage" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Conforme">‚úÖ Conforme</option>
                            <option value="Non conforme">‚ùå Non conforme</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Serrage SI <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_si_serrage" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Correct">‚úÖ Correct</option>
                            <option value="Insuffisant">‚ö†Ô∏è Insuffisant</option>
                            <option value="Excessif">‚ö†Ô∏è Excessif</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Montage panneau sur SI <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_panneau_montage" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Conforme">‚úÖ Conforme</option>
                            <option value="Non conforme">‚ùå Non conforme</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Serrage panneau <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_panneau_serrage" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Correct">‚úÖ Correct</option>
                            <option value="Insuffisant">‚ö†Ô∏è Insuffisant</option>
                            <option value="Excessif">‚ö†Ô∏è Excessif</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Conformit√© notice montage <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_notice_conforme" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Respect√©e">‚úÖ Respect√©e</option>
                            <option value="Non respect√©e">‚ùå Non respect√©e</option>
                            <option value="Notice non disponible">‚ö†Ô∏è Notice non disponible</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <label>ETN syst√®me int√©gration <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_etn">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Conforme ETN">‚úÖ Conforme ETN</option>
                            <option value="Non applicable">N/A - Non applicable</option>
                            <option value="Non conforme">‚ùå Non conforme</option>
                        </select>
                    </div>
                </div>
                
                <!-- 8.3 CHEMINEMENTS TOITURE -->
                <div class="subsection">
                    <div class="subsection-title">8.3 Cheminements Toiture</div>
                    
                    <div class="question required">
                        <label>Fixation chemin de c√¢bles toiture <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_fixation_cables" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Ad√©quate">‚úÖ Ad√©quate</option>
                            <option value="Inad√©quate">‚ùå Inad√©quate</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Maintien √©tanch√©it√© toiture <span class="norm">CDC ¬ß2.5 / DTU 40.35</span></label>
                        <select id="toiture_etancheite" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Pr√©serv√©">‚úÖ Pr√©serv√©</option>
                            <option value="Compromis">‚ùå Compromis</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Cheminement c√¢bles (pas directement sur couverture) <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_cheminement" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Conforme - pas sur couverture">‚úÖ Conforme - pas sur couverture</option>
                            <option value="Non conforme - sur couverture">‚ùå Non conforme - sur couverture</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <label>Supports fixation pertinents <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_supports">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui - pertinents">‚úÖ Oui - pertinents</option>
                            <option value="Non - non pertinents">‚ùå Non - non pertinents</option>
                        </select>
                    </div>
                </div>
                
                <!-- 8.4 CONNECTEURS -->
                <div class="subsection">
                    <div class="subsection-title">8.4 Connecteurs</div>
                    
                    <div class="question">
                        <label>Type connecteurs <span class="norm">CDC ¬ß2.5</span></label>
                        <input type="text" id="toiture_type_connecteurs" placeholder="Ex: PVZH202B, MC4, autre">
                    </div>
                    
                    <div class="question required">
                        <label>Compatibilit√© m√¢le/femelle <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_connecteurs_compatible" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Compatible">‚úÖ Compatible</option>
                            <option value="Incompatible">‚ùå Incompatible</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Serrage connecteurs <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_connecteurs_serrage" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Correct">‚úÖ Correct</option>
                            <option value="Insuffisant">‚ö†Ô∏è Insuffisant</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>√âtanch√©it√© connecteurs <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_connecteurs_etancheite" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Bonne">‚úÖ Bonne</option>
                            <option value="Douteuse">‚ö†Ô∏è Douteuse</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Exposition ruissellement <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_connecteurs_ruissellement" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Prot√©g√©e">‚úÖ Prot√©g√©e</option>
                            <option value="Expos√©e (risque)">‚ùå Expos√©e (risque)</option>
                        </select>
                    </div>
                </div>
                
                <!-- 8.5 REP√âRAGE ET S√âCURIT√â -->
                <div class="subsection">
                    <div class="subsection-title">8.5 Rep√©rage et S√©curit√©</div>
                    
                    <div class="question">
                        <label>Type rep√©rage c√¢bles toiture <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_reperage_type">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Tenant-aboutissant">‚úÖ Tenant-aboutissant</option>
                            <option value="S√©rigraphi√©">‚úÖ S√©rigraphi√©</option>
                            <option value="Manuscrit">‚ö†Ô∏è Manuscrit</option>
                            <option value="Absent">‚ùå Absent</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>√âtiquettes tension DC pr√©sentes <span class="norm">CDC ¬ß2.5</span></label>
                        <select id="toiture_etiquettes_dc" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Pr√©sentes">‚úÖ Pr√©sentes</option>
                            <option value="Absentes">‚ùå Absentes</option>
                        </select>
                    </div>
                </div>
                
                <!-- 8.6 CONFORMIT√â DTU 40.35 -->
                <div class="subsection">
                    <div class="subsection-title">8.6 Conformit√© DTU 40.35</div>
                    
                    <div class="question">
                        <label>Couverture plaques nervur√©es <span class="norm">DTU 40.35</span></label>
                        <select id="toiture_dtu_couverture">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Conforme DTU">‚úÖ Conforme DTU</option>
                            <option value="Non conforme">‚ùå Non conforme</option>
                            <option value="Non applicable">N/A - Non applicable</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <label>Points singuliers √©tanch√©it√© trait√©s <span class="norm">DTU 40.35</span></label>
                        <select id="toiture_points_singuliers">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Trait√©s">‚úÖ Trait√©s</option>
                            <option value="Non trait√©s">‚ùå Non trait√©s</option>
                        </select>
                    </div>
                </div>
                
                <!-- 8.7 REMONTAGE -->
                <div class="subsection">
                    <div class="subsection-title">8.7 Remontage</div>
                    
                    <div class="question required">
                        <label>Panneaux remont√©s <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_remontage" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui">‚úÖ Oui</option>
                            <option value="Non">‚ùå Non</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Int√©grit√© panneaux pr√©serv√©e <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_integrite_panneaux" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui">‚úÖ Oui</option>
                            <option value="Non">‚ùå Non</option>
                        </select>
                    </div>
                    
                    <div class="question required">
                        <label>Int√©grit√© supports pr√©serv√©e <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_integrite_supports" required>
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui">‚úÖ Oui</option>
                            <option value="Non">‚ùå Non</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <label>Notice montage respect√©e au remontage <span class="norm">CDC ¬ß2.2</span></label>
                        <select id="toiture_notice_remontage">
                            <option value="">-- S√©lectionner --</option>
                            <option value="Oui">‚úÖ Oui</option>
                            <option value="Non">‚ùå Non</option>
                            <option value="Impossible (raison valide)">‚ö†Ô∏è Impossible (pr√©ciser pourquoi)</option>
                        </select>
                    </div>
                    
                    <div class="question">
                        <label>Si impossible respecter notice, pr√©ciser pourquoi</label>
                        <textarea id="toiture_notice_impossible" placeholder="Raisons techniques emp√™chant respect notice..."></textarea>
                    </div>
                </div>
                
                <div class="question">
                    <label>Observations audit toiture</label>
                    <textarea id="toiture_observations" placeholder="Constats g√©n√©raux, non-conformit√©s DTU 40.35, ETN, points d'attention..."></textarea>
                </div>
                
                <!-- PHOTOS TOITURE D√âTAIL -->
                <div class="photo-section">
                    <div class="photo-header">
                        <span class="photo-category">üì∏ PHOTOS TOITURE D√âTAIL (TOITURE-DETAIL)</span>
                        <span class="photo-count" id="count_TOITURE_DETAIL">0 photos</span>
                    </div>
                    <div class="photo-guide">
                        <strong>üìã √Ä photographier (minimum 15 photos) :</strong>
                        ‚Ä¢ D√©montage panneaux (avant/apr√®s)<br>
                        ‚Ä¢ Syst√®me int√©gration SI (montage sur support)<br>
                        ‚Ä¢ Fixation panneau sur SI (d√©tails serrage)<br>
                        ‚Ä¢ Connecteurs (type, compatibilit√©, serrage, √©tanch√©it√©)<br>
                        ‚Ä¢ Cheminement c√¢bles toiture (supports, fixations)<br>
                        ‚Ä¢ √âtanch√©it√© toiture (points singuliers, passages)<br>
                        ‚Ä¢ Rep√©rage c√¢bles<br>
                        ‚Ä¢ √âtiquettes tension DC<br>
                        ‚Ä¢ Remontage panneaux (√©tapes)<br>
                        ‚Ä¢ √âtat final apr√®s remontage<br>
                        ‚Ä¢ Tout d√©faut ou non-conformit√© DTU/ETN
                    </div>
                    <input type="file" id="photo_TOITURE_DETAIL" accept="image/*" multiple capture="environment">
                    <button class="btn-photo" onclick="document.getElementById('photo_TOITURE_DETAIL').click()">
                        üì∑ PRENDRE/AJOUTER PHOTOS TOITURE D√âTAIL
                    </button>
                    <div class="photo-preview" id="preview_TOITURE_DETAIL"></div>
                </div>
            </div>
        </div>

        <!-- SECTION 9 : G√âN√âRAL & ENVIRONNEMENT -->
        <div class="section">
            <div class="section-header">
                <span>üåç 9. VUE G√âN√âRALE & ENVIRONNEMENT</span>
            </div>
            
            <div class="question">
                <label>Acc√®s site</label>
                <select id="general_acces">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Facile">‚úÖ Facile</option>
                    <option value="Moyen">‚ö†Ô∏è Moyen</option>
                    <option value="Difficile">‚ùå Difficile</option>
                </select>
            </div>
            
            <div class="question">
                <label>V√©g√©tation impactante</label>
                <select id="general_vegetation">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Aucune">‚úÖ Aucune</option>
                    <option value="L√©g√®re">‚ö†Ô∏è L√©g√®re</option>
                    <option value="Importante - d√©broussaillage n√©cessaire">‚ùå Importante - d√©broussaillage n√©cessaire</option>
                </select>
            </div>
            
            <div class="question">
                <label>Ombrage</label>
                <select id="general_ombrage">
                    <option value="">-- S√©lectionner --</option>
                    <option value="Aucun">‚úÖ Aucun</option>
                    <option value="Partiel">‚ö†Ô∏è Partiel</option>
                    <option value="Important - impact production">‚ùå Important - impact production</option>
                </select>
            </div>
            
            <div class="question">
                <label>Observations g√©n√©rales</label>
                <textarea id="general_observations" placeholder="Tout √©l√©ment remarquable, anomalie, point d'attention, contexte particulier..."></textarea>
            </div>
            
            <!-- PHOTOS G√âN√âRALES -->
            <div class="photo-section">
                <div class="photo-header">
                    <span class="photo-category">üì∏ PHOTOS G√âN√âRALES (GEN)</span>
                    <span class="photo-count" id="count_GEN">0 photos</span>
                </div>
                <div class="photo-guide">
                    <strong>üìã √Ä photographier (minimum 5 photos) :</strong>
                    ‚Ä¢ Vue a√©rienne ou panoramique installation compl√®te<br>
                    ‚Ä¢ Acc√®s site (entr√©e, parking, portail)<br>
                    ‚Ä¢ Environnement imm√©diat<br>
                    ‚Ä¢ V√©g√©tation si impactante (ombrage)<br>
                    ‚Ä¢ Signal√©tique site (panneaux, affichage r√©glementaire)<br>
                    ‚Ä¢ Contexte g√©n√©ral (b√¢timents, cl√¥tures)
                </div>
                <input type="file" id="photo_GEN" accept="image/*" multiple capture="environment">
                <button class="btn-photo" onclick="document.getElementById('photo_GEN').click()">
                    üì∑ PRENDRE/AJOUTER PHOTOS G√âN√âRALES
                </button>
                <div class="photo-preview" id="preview_GEN"></div>
            </div>
        </div>

        <!-- SECTION 10 : R√âCAPITULATIF & EXPORT -->
        <div class="section">
            <div class="section-header">
                <span>üì§ 10. R√âCAPITULATIF & EXPORT</span>
            </div>
            
            <div class="alert alert-success">
                <strong>üìä R√âCAPITULATIF PHOTOS</strong><br><br>
                <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;">
                    <div>
                        <strong>DOC (Documents):</strong> <span id="total_DOC">0</span> / 5 min<br>
                        <strong>ELEC (√âlectrique):</strong> <span id="total_ELEC">0</span> / 10 min<br>
                        <strong>TRANCHEES (Tranch√©es):</strong> <span id="total_TRANCHEES">0</span> / 2 min<br>
                        <strong>MP (Modules):</strong> <span id="total_MP">0</span> / 10 min
                    </div>
                    <div>
                        <strong>TOIT (Structure):</strong> <span id="total_TOIT">0</span> / 5 min<br>
                        <strong>BP (Bo√Ætes):</strong> <span id="total_BP">0</span> / 3 min<br>
                        <strong>GEN (G√©n√©ral):</strong> <span id="total_GEN">0</span> / 5 min<br>
                        <strong>TOITURE-DETAIL:</strong> <span id="total_TOITURE_DETAIL">0</span> / 15 min (si applicable)
                    </div>
                </div>
                <hr style="margin: 15px 0; border: none; border-top: 2px solid #155724;">
                <strong style="font-size: 16px;">TOTAL: <span id="total_ALL">0</span> photos / <span id="photos_min_required">40</span> minimum requis</strong>
            </div>
            
            <div class="alert alert-info">
                <strong>üíæ SAUVEGARDE AUTOMATIQUE :</strong><br>
                Vos donn√©es sont sauvegard√©es localement toutes les 10 secondes.<br>
                Vous pouvez fermer et rouvrir cette page sans perdre vos donn√©es.
            </div>
            
            <button class="btn-export" onclick="exporterJSON()">
                üì• EXPORTER CHECKLIST V4 CDC COMPL√àTE (JSON)
            </button>
            
            <div class="alert alert-info">
                <strong>üì§ APR√àS EXPORT :</strong><br>
                1. R√©cup√®re le fichier <strong>82721_audit_v4_terrain.json</strong><br>
                2. Envoie-le par email √† <strong>contact@diagpv.fr</strong><br>
                3. Ou copie-le dans <strong>/exports_json/</strong> pour g√©n√©ration automatique rapport CDC
            </div>
            
            <div class="alert alert-success">
                <strong>‚úÖ CONFORMIT√â CDC GIRASOLE V4 :</strong><br>
                Cette checklist couvre 100% des exigences CDC PERF-CDC-001 :<br>
                ‚Ä¢ Prescriptions documentaires GIRASOLE (4 points) ‚úÖ<br>
                ‚Ä¢ Conformit√© √©lectrique NF C 15-100 / UTE C 15-712-1 (25 points) ‚úÖ<br>
                ‚Ä¢ Tranch√©es AC (2 points) ‚úÖ<br>
                ‚Ä¢ Modules PV (7 points d√©taill√©s) ‚úÖ<br>
                ‚Ä¢ Structure support (5 points d√©taill√©s) ‚úÖ<br>
                ‚Ä¢ Bo√Ætes protection (4 points d√©taill√©s) ‚úÖ<br>
                ‚Ä¢ Audit toiture DTU 40.35 / ETN (13 points si applicable) ‚úÖ<br>
                <strong>TOTAL : 54 points techniques CDC + 40-55 photos minimum</strong>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <p><strong>Diagnostic Photovolta√Øque - Groupe Watt&co</strong></p>
            <p>Expert ind√©pendant audits PV - Conforme IEC 62446-1, NF C 15-100, UTE C 15-712-1, DTU 40.35</p>
            <p>3 rue d'Apollo, 31240 L'UNION</p>
            <p>‚òéÔ∏è 05.81.10.16.59 | üìß contact@diagpv.fr | üåê www.diagnosticphotovoltaique.fr</p>
            <p style="margin-top: 10px;">RCS Toulouse 792 972 309 | Mission GIRASOLE 2025 - Version V4.0 CDC Compl√®te</p>
        </div>
    </div>

    <script>
        const CENTRALE_ID = '82721';
        const CENTRALE_NOM = 'Cheraud';
        const CENTRALE_TYPE = 'SOL';
        const STORAGE_KEY = 'checklist_v4_' + CENTRALE_ID;
        
        const photos = {
            DOC: [],
            ELEC: [],
            TRANCHEES: [],
            MP: [],
            TOIT: [],
            BP: [],
            GEN: [],
            TOITURE_DETAIL: []
        };
        
        // Initialize date
        document.getElementById('date_intervention').value = new Date().toISOString().split('T')[0];
        
        // Toggle toiture section visibility
        function toggleToitureSection() {
            const applicable = document.getElementById('toiture_applicable').value;
            const details = document.getElementById('toiture_details');
            const section = document.getElementById('section_toiture');
            
            if (applicable === 'Oui') {
                section.style.display = 'block';
                details.style.display = 'block';
                document.getElementById('photos_min_required').textContent = '55';
            } else {
                section.style.display = 'block';
                details.style.display = 'none';
                document.getElementById('photos_min_required').textContent = '40';
            }
        }
        
        // Photo handling
        ['DOC', 'ELEC', 'TRANCHEES', 'MP', 'TOIT', 'BP', 'GEN', 'TOITURE_DETAIL'].forEach(cat => {
            const input = document.getElementById('photo_' + cat);
            if (input) {
                input.addEventListener('change', function(e) {
                    const files = e.target.files;
                    let processed = 0;
                    
                    for (let file of files) {
                        const reader = new FileReader();
                        reader.onload = function(event) {
                            photos[cat].push({
                                categorie: cat,
                                nom: file.name,
                                taille: file.size,
                                type: file.type,
                                data: event.target.result,
                                date: new Date().toISOString()
                            });
                            
                            const img = document.createElement('img');
                            img.src = event.target.result;
                            img.onclick = function() { window.open(event.target.result); };
                            document.getElementById('preview_' + cat).appendChild(img);
                            
                            processed++;
                            if (processed === files.length) {
                                updatePhotoStats();
                                updateProgress();
                                saveLocal();
                            }
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
        });
        
        function updatePhotoStats() {
            let total = 0;
            ['DOC', 'ELEC', 'TRANCHEES', 'MP', 'TOIT', 'BP', 'GEN', 'TOITURE_DETAIL'].forEach(cat => {
                const count = photos[cat].length;
                const countEl = document.getElementById('count_' + cat);
                const totalEl = document.getElementById('total_' + cat);
                if (countEl) countEl.textContent = count + ' photo' + (count > 1 ? 's' : '');
                if (totalEl) totalEl.textContent = count;
                total += count;
            });
            document.getElementById('total_ALL').textContent = total;
        }
        
        function updateProgress() {
            const requiredFields = document.querySelectorAll('.question.required input, .question.required select, .question.required textarea');
            let filled = 0;
            requiredFields.forEach(field => {
                if (field.value && field.value.trim() !== '') filled++;
            });
            
            const percentage = Math.round((filled / requiredFields.length) * 100);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percentage + '%';
            progressBar.textContent = percentage + '% compl√©t√©';
        }
        
        // Auto-save every 10s
        setInterval(saveLocal, 10000);
        
        // Save on field change
        document.querySelectorAll('input, select, textarea').forEach(el => {
            el.addEventListener('change', () => {
                updateProgress();
                saveLocal();
            });
        });
        
        function saveLocal() {
            const data = {
                centrale: {
                    id: CENTRALE_ID,
                    nom: CENTRALE_NOM,
                    type: CENTRALE_TYPE
                },
                formulaire: collectFormData(),
                photos: photos,
                timestamp: new Date().toISOString(),
                version: '4.0'
            };
            localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }
        
        function loadLocal() {
            const saved = localStorage.getItem(STORAGE_KEY);
            if (saved) {
                const data = JSON.parse(saved);
                if (confirm('Donn√©es sauvegard√©es trouv√©es. Voulez-vous les charger ?')) {
                    // Restore form data
                    Object.keys(data.formulaire).forEach(key => {
                        const el = document.getElementById(key);
                        if (el) el.value = data.formulaire[key];
                    });
                    
                    // Restore photos
                    Object.keys(data.photos).forEach(cat => {
                        photos[cat] = data.photos[cat];
                        data.photos[cat].forEach(photo => {
                            const img = document.createElement('img');
                            img.src = photo.data;
                            img.onclick = function() { window.open(photo.data); };
                            const preview = document.getElementById('preview_' + cat);
                            if (preview) preview.appendChild(img);
                        });
                    });
                    
                    updatePhotoStats();
                    updateProgress();
                }
            }
        }
        
        function collectFormData() {
            const fields = document.querySelectorAll('input[id], select[id], textarea[id]');
            const data = {};
            fields.forEach(field => {
                if (field.id && field.id !== '' && field.type !== 'file') {
                    data[field.id] = field.value;
                }
            });
            return data;
        }
        
        function exporterJSON() {
            const data = {
                metadata: {
                    version: '4.0',
                    conformite_cdc: '100%',
                    norme_reference: 'CDC PERF-CDC-001',
                    normes_appliquees: ['IEC 62446-1', 'NF C 15-100', 'UTE C 15-712-1', 'DTU 40.35'],
                    date_export: new Date().toISOString()
                },
                centrale: {
                    id: CENTRALE_ID,
                    nom: CENTRALE_NOM,
                    puissance_kwc: 499.59,
                    adresse: 'Bellevue, 44260 Malville, France',
                    type: CENTRALE_TYPE
                },
                audit: collectFormData(),
                photos: photos,
                statistiques: {
                    total_photos: Object.values(photos).flat().length,
                    photos_par_categorie: {
                        DOC: photos.DOC.length,
                        ELEC: photos.ELEC.length,
                        TRANCHEES: photos.TRANCHEES.length,
                        MP: photos.MP.length,
                        TOIT: photos.TOIT.length,
                        BP: photos.BP.length,
                        GEN: photos.GEN.length,
                        TOITURE_DETAIL: photos.TOITURE_DETAIL.length
                    }
                }
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = CENTRALE_ID + '_audit_v4_terrain_' + new Date().toISOString().split('T')[0] + '.json';
            a.click();
            URL.revokeObjectURL(url);
            
            alert('‚úÖ Export JSON V4 CDC complet r√©ussi !\\n\\nFichier: ' + a.download + '\\nTaille: ' + Math.round(blob.size / 1024) + ' KB\\nPhotos: ' + Object.values(photos).flat().length);
        }
        
        // Load saved data on page load
        window.addEventListener('load', () => {
            loadLocal();
            updateProgress();
        });
    </script>
</body>
</html>
